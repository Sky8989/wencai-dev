<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.1//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sftc.web.mapper.OrderMapper">


        <!--  提交订单  -->
        <insert id="addOrder" parameterType="com.sftc.web.model.Order">
                INSERT INTO sftc_order ( create_time,  order_number,  state,  gmt_order_create,  gmt_pay_create,
                  pay_method,  distribution_method,  freight,  sender_name,  sender_mobile,
                  sender_province,  sender_city,  sender_area,  sender_addr,  word_message,
                  image,  voice,  longitude,  latitude,  gift_card_id,  user_id,  courier_id)
                 VALUES (#{create_time},#{order_number},#{state},#{gmt_order_create},#{gmt_pay_create},
                #{pay_method},#{distribution_method},#{freight},#{sender_name},#{sender_mobile},
                #{sender_province},#{sender_city},
                #{sender_area},#{sender_addr},#{word_message},#{image},#{voice},#{longitude},
                #{latitude},#{gift_card_id},#{user_id},#{courier_id})
        </insert>

    <!-- 提交订单  -->
    <insert id="addOrderExpress" parameterType="com.sftc.web.model.OrderExpress">
        INSERT INTO sftc_order ( create_time,  order_number,  ship_name,  ship_mobile,  ship_province,
        ship_city,  ship_area,  ship_addr,  package_type,  object_type)
        VALUES (#{create_time},#{order_number},#{ship_name},#{ship_mobile},#{ship_province},
        #{ship_city},#{ship_area},#{ship_addr},#{package_type},#{object_type})
    </insert>


    <!--修改订单   -->
    <update id="updateOrder" parameterType="com.sftc.web.model.Order">
        update sftc_order
        <trim prefix="set" suffixOverrides=",">
            <if test="sender_mobile!=null">sender_mobile=#{sender_mobile},</if>
            <if test="sender_name!=null">sender_name=#{sender_name},</if>
            <if test="sender_province!=null">sender_province=#{sender_province},</if>
            <if test="sender_city!=null">sender_city=#{sender_city},</if>
            <if test="sender_area!=null">sender_area=#{sender_area},</if>
            <if test="sender_addr!=null">sender_addr=#{sender_addr},</if>

            <if test="word_message!=null">word_message=#{word_message},</if>
            <if test="image!=null">image=#{image},</if>
            <if test="gift_card_id!=null">gift_card_id=#{gift_card_id},</if>
            <if test="pay_method!=null">pay_method=#{pay_method},</if>

        </trim>
        WHERE order_number=#{order_number}
    </update>
    <!-- 修改订单  -->
    <update id="updateOrderExpress" parameterType="com.sftc.web.model.Order">
        update sftc_order
        <trim prefix="set" suffixOverrides=",">
            <if test="ship_mobile!=null">ship_mobile=#{ship_mobile},</if>
            <if test="ship_name!=null">ship_name=#{ship_name},</if>
            <if test="ship_province!=null">ship_province=#{ship_province},</if>
            <if test="ship_city!=null">ship_city=#{ship_city},</if>
            <if test="ship_area!=null">ship_area=#{ship_area},</if>
            <if test="ship_addr!=null">ship_addr=#{ship_addr},</if>
            <if test="type!=null">type=#{type},</if>
            <if test="size!=null">size=#{size},</if>
            <!--    <if test="voice!=null">voice=#{voice}</if> -->
        </trim>
        WHERE order_number=#{order_number}
    </update>
    <!-- 查看订单详情  -->
    <select id="orderDetile" resultType="com.sftc.web.model.Order" parameterType="string" resultMap="OrderExpressMap">
        SELECT o.sender_mobile, o.sender_name, o.sender_province,state,
        o.sender_city, o.sender_area, o.sender_addr, o.voice,image ,o.pay_method,o.distribution_method,o.gmt_order_create,
        o.gmt_pay_create,o.order_number ,oe.order_number,oe.ship_province,
        oe.ship_name,  oe.ship_city,  oe.ship_area,  oe.ship_addr,  oe.package_type,oe.object_type
        FROM sftc_order o,sftc_order_express oe WHERE o.order_number=#{order_number}  and oe.order_number=o.order_number


    </select>
    <resultMap id="OrderExpressMap" type="com.sftc.web.model.Order">
        <id column="id" property="id"/>
        <result property="order_number" column="order_number"/>
        <result property="sender_mobile" column="sender_mobile"/>
        <collection property="orderExpressList"  ofType="com.sftc.web.model.OrderExpress">
            <id column="id" property="id"/>
            <result column="ship_name" property="ship_name"/>
            <result property="order_number" column="order_number"/>
        </collection>
    </resultMap>






        <!-- 好友填写地址  -->
        <insert id="friendWriteAddress" parameterType="com.sftc.web.model.Order">
                INSERT INTO sftc_order (ship_mobile, ship_name,ship_province, ship_city,
                ship_area, ship_addr) VALUES (#{ship_mobile},#{ship_name},#{ship_province},
                #{ship_city},#{ship_area},#{ship_addr})
        </insert>



</mapper>